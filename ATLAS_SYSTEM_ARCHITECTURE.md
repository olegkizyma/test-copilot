# ATLAS - Архітектура Системи v4.0
## Adaptive Task and Learning Assistant System

---

## 🎯 Загальний опис системи

**ATLAS** - це інтелектуальна система з трьома AI-агентами, що працюють разом для автономного виконання завдань через природний діалог та верифікацію результатів.

### Основні принципи:
- **Prompt-Driven Logic** - вся логіка базується на ролях агентів
- **Безкомпромісне виконання** - система знаходить рішення будь-яким шляхом
- **Живі агенти** - імітація природної людської комунікації
- **Повна автономність** - мінімальне втручання користувача

---

## 🏗 Архітектура системи

```
┌─────────────────────────────────────────────────────────────┐
│                    ATLAS SYSTEM v4.0                       │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐     │
│  │   ATLAS     │◄──►│   TETYANA   │◄──►│   GRISHA    │     │
│  │ Coordinator │    │  Executor   │    │ Verificator │     │
│  │             │    │   (Goose)   │    │             │     │
│  └─────────────┘    └─────────────┘    └─────────────┘     │
│         │                   │                   │          │
│         └───────────────────┼───────────────────┘          │
│                             │                              │
│  ┌─────────────────────────────────────────────────────────┤
│  │              ORCHESTRATOR ENGINE                        │
│  │              (Workflow Management)                      │
│  └─────────────────────────────────────────────────────────┤
│                             │                              │
│  ┌─────────────────────────────────────────────────────────┤
│  │                GOOSE SERVER                             │
│  │            (AI Engine Backend)                         │
│  └─────────────────────────────────────────────────────────┤
│                             │                              │
│  ┌─────────────────────────────────────────────────────────┤
│  │              WEB INTERFACE                              │
│  │        (User Interaction Frontend)                     │
│  └─────────────────────────────────────────────────────────┤
│                             │                              │
│  ┌─────────────────────────────────────────────────────────┤
│  │                TTS SYSTEM                               │
│  │         (Ukrainian Text-to-Speech)                     │
│  └─────────────────────────────────────────────────────────┘
```

---

## 📁 Детальна структура проекту

### `/` - Корінь проекту
```
atlas4/
├── restart_system.sh          # 🎛️ Головний скрипт управління системою
├── README.md                  # 📖 Основна документація
├── TECHNICAL_SPECIFICATION.md # 📋 Технічні вимоги
├── Makefile                   # 🔧 Команди збірки та запуску
├── package.json               # 📦 Node.js залежності  
└── requirements.txt           # 🐍 Python залежності
```

**Призначення**: Основне управління та документація всієї системи.

---

### `/agent_prompts/` - Інтелект агентів
```
agent_prompts/
├── workflow_config.js         # ⚙️ Конфігурація послідовності workflow
├── atlas/                     # 🧠 Промпти координатора Atlas
│   ├── stage1_initial_processing.js    # 📝 Перша обробка завдання
│   ├── stage3_clarification.js         # ❓ Уточнення від користувача
│   ├── stage6_task_adjustment.js       # 🔄 Корекція завдання
│   └── stage7_retry_cycle.js           # 🔁 Новий цикл виконання
├── tetyana/                   # 💪 Промпти виконавця Tetyana
│   ├── stage2_execution.js             # ⚡ Основне виконання
│   └── stage4_retry.js                 # 🔄 Повторне виконання
└── grisha/                    # 🛡️ Промпти верифікатора Grisha
    ├── stage5_diagnosis.js             # 🔍 Діагностика проблем
    └── stage7_verification.js          # ✅ Перевірка результатів
```

**Призначення**: Містить персональності, ролі та інструкції для кожного AI-агента на різних етапах роботи.

---

### `/frontend_new/` - Веб-інтерфейс та оркестратор
```
frontend_new/
├── app/                       # 🌐 Flask веб-додаток
│   ├── atlas_server.py        # 🖥️ Головний сервер (порт 5001)
│   ├── goose_client.py        # 🔌 Клієнт для Goose API
│   ├── static/                # 📁 Статичні ресурси
│   │   ├── css/main.css       # 🎨 Стилі інтерфейсу
│   │   ├── js/
│   │   │   ├── app.js         # 📱 Основна логіка додатку
│   │   │   ├── intelligent-chat-manager.js  # 💬 Менеджер чату з агентами
│   │   │   ├── status-manager.js            # 📊 Управління статусами
│   │   │   └── logger-manager.js            # 📋 Система логування
│   │   └── assets/            # 🖼️ Зображення, іконки, 3D моделі
│   └── templates/index.html   # 📄 Головна сторінка
├── orchestrator/              # 🎭 Node.js оркестратор
│   ├── server.js              # 🎯 Головний оркестратор (порт 5101)
│   └── server_no_verification.js  # 🎯 Спрощена версія без верифікації
└── config/                    # ⚙️ Конфігураційні файли
    └── recovery_bridge_integration.js  # 🌉 Мостовий сервіс
```

**Призначення**: Веб-інтерфейс для взаємодії з користувачем та оркестратор для управління агентами.

---

### `/ukrainian-tts/` - Система озвучування
```
ukrainian-tts/
├── tts_server.py              # 🔊 TTS сервер (порт 3001)
├── quick_tts_demo.py          # 🎤 Демо синтезу мовлення
├── model.pth                  # 🧠 Нейронна мережа (446MB)
├── config.yaml                # ⚙️ Конфігурація TTS
├── ukrainian_tts/             # 📦 Основний TTS модуль
├── vocoder/                   # 🎵 Вокодер для генерації звуку
├── fx_presets/                # 🎛️ Аудіо ефекти
└── samples/                   # 🎵 Зразки голосів
```

**Призначення**: Український TTS для озвучування відповідей агентів різними голосами.

---

### `/logs/` - Система логування
```
logs/
├── orchestrator.log           # 📝 Логи оркестратора та workflow
├── goose_web.log              # 📝 Логи Goose веб-сервера
├── frontend.log               # 📝 Логи веб-інтерфейсу
├── tts.log                    # 📝 Логи TTS системи
├── recovery_bridge.log        # 📝 Логи мостового сервісу
└── archive/                   # 📂 Архівні логи
```

**Призначення**: Централізоване логування всіх компонентів системи.

---

## 🔄 Workflow - Логіка роботи агентів

### Послідовність етапів:

1. **Stage 1**: `ATLAS` - Початкова обробка (формалізація завдання)
2. **Stage 2**: `TETYANA` - Виконання завдання  
3. **Stage 3**: `ATLAS` - Уточнення (за потреби)
4. **Stage 4**: `TETYANA` - Повторне виконання з уточненнями
5. **Stage 5**: `GRISHA` - Діагностика (якщо блокування)
6. **Stage 6**: `ATLAS` - Корекція завдання  
7. **Stage 7**: `GRISHA` - Верифікація результатів ✅
8. **Stage 8**: `SYSTEM` - Завершення workflow
9. **Stage 9**: `ATLAS` - Новий цикл (якщо потрібно)

### Ролі агентів:
- **🧠 ATLAS** (зелений) - Координатор, стратег, куратор
- **💪 TETYANA** (блакитний) - Виконавець, реалізатор завдань  
- **🛡️ GRISHA** (жовтий) - Верифікатор, контроль якості

---

## 🌐 Мережева архітектура

### Порти та сервіси:
```
┌─────────────────────────────────────────────────────────────┐
│  Port 3000: Goose Web Server     (AI Backend Engine)       │
│  Port 3001: TTS Server           (Ukrainian Text-to-Speech) │  
│  Port 5001: Frontend Server      (Web Interface)           │
│  Port 5101: Orchestrator Server  (Agent Management)        │
│  Port 5102: Recovery Bridge      (System Recovery)         │
└─────────────────────────────────────────────────────────────┘
```

### Потік даних:
```
[Користувач] → [Web UI:5001] → [Orchestrator:5101] → [Goose:3000]
                ↑                      ↓
            [TTS:3001] ← [Voice System] ← [Agent Response]
```

---

## 🛠 Технічний стек

### Backend:
- **Python 3.9+** - Основна мова для веб-сервера та TTS
- **Node.js 16+** - Оркестратор та управління workflow  
- **Flask** - Веб-фреймворк для фронтенду
- **Express.js** - API сервер для оркестратора

### AI & ML:
- **Goose Desktop/CLI** - AI движок для агентів
- **GitHub Copilot** - Базова модель для Goose
- **Ukrainian TTS Model** - Локальна нейронна мережа 446MB

### Frontend:
- **Vanilla JavaScript** - Клієнтська логіка
- **WebSocket** - Реальний час комунікації
- **Model Viewer** - 3D візуалізація
- **Responsive CSS** - Адаптивний дизайн

### DevOps:
- **Bash scripts** - Автоматизація запуску/зупинки
- **Makefile** - Команди збірки
- **Git** - Контроль версій

---

## 🚀 Команди управління

### Основні команди:
```bash
# Запуск всієї системи
./restart_system.sh start

# Зупинка системи  
./restart_system.sh stop

# Перезапуск
./restart_system.sh restart

# Діагностика
./restart_system.sh diagnose

# Перегляд статусу
./restart_system.sh status

# Очищення логів
./restart_system.sh clean
```

### Make команди:
```bash
make install    # Встановлення залежностей
make start      # Запуск системи
make stop       # Зупинка системи  
make clean      # Очищення
```

---

## 🔧 Конфігурація та налаштування

### Основні конфігураційні файли:
- `config.yaml` - Загальна конфігурація системи
- `agent_prompts/workflow_config.js` - Послідовність етапів агентів
- `frontend_new/config/` - Налаштування веб-інтерфейсу  
- `ukrainian-tts/config.yaml` - Конфігурація TTS системи

### Змінні середовища:
- `GOOSE_SERVER_PORT=3000` - Порт Goose сервера
- `TTS_PORT=3001` - Порт TTS сервера
- `FRONTEND_PORT=5001` - Порт веб-інтерфейсу
- `ORCH_PORT=5101` - Порт оркестратора

---

## 📊 Моніторинг та логування

### Система логування:
- **Централізовані логи** в `/logs/`
- **Ротація логів** через `restart_system.sh clean`
- **Різні рівні логування** (INFO, WARN, ERROR)
- **Архівування** старих логів

### Діагностика:
- Перевірка портів та процесів
- Валідація конфігурацій
- Статус всіх сервісів
- Тестування з'єднань

---

## 🎯 Особливості системи

### Унікальні можливості:
1. **Природна комунікація агентів** - діалог як між людьми
2. **Автоматична верифікація** - Гриша перевіряє всі результати
3. **Голосове озвучування** - українські голоси для кожного агента
4. **Адаптивний workflow** - система сама вирішує, коли потрібні уточнення
5. **Повна автономність** - мінімальне втручання користувача

### Переваги архітектури:
- **Модульність** - кожен компонент незалежний
- **Масштабованість** - легко додавати нових агентів
- **Відмовостійкість** - система відновлюється після збоїв
- **Простота управління** - один скрипт для всього

---

## 📈 Розвиток системи

### Поточна версія: v4.0
- ✅ 3 інтелектуальних агенти
- ✅ Український TTS
- ✅ Веб-інтерфейс з 3D
- ✅ Автоматична верифікація
- ✅ Централізоване управління

### Планові вдосконалення:
- 🔄 Додаткові агенти-спеціалісти
- 🔄 Підтримка інших мов TTS  
- 🔄 Розширені можливості діагностики
- 🔄 API для інтеграції з іншими системами

---

*Документ створено автоматично системою ATLAS v4.0*  
*Останнє оновлення: 2025-01-20*
